# tmux Pro Preset
# Full-featured with system stats, git, battery, and more
# Colors are sourced from MacTheme tmux-colors.conf

# General settings
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",xterm-256color:Tc"
set -g mouse on
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g history-limit 50000

# Status bar position and update interval
set -g status-position top
set -g status-interval 2

# Status bar styling
set -g status-style "bg=#{@background},fg=#{@foreground}"
set -g status-left-length 60
set -g status-right-length 120

# Helper scripts for system info
# CPU usage
CPU_CMD='top -l 1 | grep -E "^CPU" | awk '\''{print $3}'\'' | cut -d% -f1'
# Memory usage
MEM_CMD='memory_pressure 2>/dev/null | grep "System-wide memory free percentage:" | awk '\''{print 100-$5}'\'' | cut -d% -f1 || echo "N/A"'
# Battery
BAT_CMD='pmset -g batt | grep -Eo "\d+%" | head -1'

# Left side: session info with window/pane count
set -g status-left "#[fg=#{@background},bg=#{@accent},bold]  #S #[fg=#{@accent},bg=#{@blue}]#[fg=#{@background},bg=#{@blue}] #I:#P #[fg=#{@blue},bg=#{@background}] "

# Right side: git, cpu, memory, battery, date/time
set -g status-right "\
#[fg=#{@selection}]#[fg=#{@foreground},bg=#{@selection}]  #(cd #{pane_current_path}; git branch --show-current 2>/dev/null || echo '-') \
#[fg=#{@green},bg=#{@selection}]#[fg=#{@background},bg=#{@green}] 󰻠 #($CPU_CMD)%% \
#[fg=#{@yellow},bg=#{@green}]#[fg=#{@background},bg=#{@yellow}] 󰍛 #($MEM_CMD)%% \
#[fg=#{@cyan},bg=#{@yellow}]#[fg=#{@background},bg=#{@cyan}]  #($BAT_CMD) \
#[fg=#{@accent},bg=#{@cyan}]#[fg=#{@background},bg=#{@accent},bold]  %a %d  %H:%M "

# Window styling with powerline
set -g window-status-format "#[fg=#{@background},bg=#{@selection}]#[fg=#{@foreground},bg=#{@selection}] #I #W #[fg=#{@selection},bg=#{@background}]"
set -g window-status-current-format "#[fg=#{@background},bg=#{@accent}]#[fg=#{@background},bg=#{@accent},bold] #I #W #[fg=#{@accent},bg=#{@background}]"

# Window separator
set -g window-status-separator ""

# Pane borders
set -g pane-border-style "fg=#{@selection}"
set -g pane-active-border-style "fg=#{@accent}"

# Message styling
set -g message-style "bg=#{@accent},fg=#{@background},bold"

# Copy mode styling
setw -g mode-style "bg=#{@selection},fg=#{@foreground}"

# Activity monitoring
setw -g monitor-activity on
set -g visual-activity off
set -g window-status-activity-style "fg=#{@yellow}"
